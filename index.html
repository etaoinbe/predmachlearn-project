<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>predmachlearn project</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>predmachlearn project</h1>

<h1><a href="http://etaoinbe.github.io/predmachlearn-project/">http://etaoinbe.github.io/predmachlearn-project/</a></h1>

<p>First attempt at machine learning was with a decision tree approach. The first tree that came out depended only on X. 
However the predict function didnt like it. When I looked at X I saw it was like a sequence no with no real predicting value. 
In the end I removed several more variables amongst which the columns that are all NA. </p>

<p>What tripped me up for quite some time is that read.csv converts incomplete
numeric fields to factors. This gave memory errors and general instability in R.</p>

<p>Then I finally got some results. However accuracy was really bad only like 40%. 
So I decided to go for random forest next. I first tried to run it on the full training set but this never ended. 
So in the end I reduced the set to 6000 records, this claimed 100% accuracy. </p>

<p>Initially I used the validation set to do the out of sample estimation but after rereading the assignment I figured out that we need to estimate the out of sample error using cross validation. Both numbers are available below.</p>

<pre><code class="r">library(caret)
</code></pre>

<pre><code>## Loading required package: lattice
## Loading required package: ggplot2
</code></pre>

<pre><code class="r">library(rattle)
</code></pre>

<pre><code>## Rattle: A free graphical interface for data mining with R.
## Version 3.0.2 r169 Copyright (c) 2006-2013 Togaware Pty Ltd.
## Type &#39;rattle()&#39; to shake, rattle, and roll your data.
</code></pre>

<pre><code class="r">#http://groupware.les.inf.puc-rio.br/public/papers/2013.Velloso.QAR-WLE.pdf

#
testmethod=&quot;rf&quot;
#testmethod=&quot;rpart&quot; 

#####################
# TRAINING
#####################

setwd(&quot;C:\\data\\lectures\\predmachlearn\\project&quot;) 

pmlData &lt;- read.csv(&quot;pml-training.csv&quot;,as.is=T,stringsAsFactors=F)

ns=names(pmlData)
for(i in 1:length(ns)) { 
  name=ns[i] 
  if(  name!=&quot;classe&quot;) { 
    if( typeof(pmlData[,name])==&quot;character&quot;  ) { #cat(&quot;!!!&quot;,name);
                                                 pmlData[, c(name)]=as.numeric( pmlData[, c(name)] )  ;
    }
    #print(sprintf(&quot;types tr %s    name %s &quot;,typeof(pmlData[, c(name)]), name ) )
  }}
</code></pre>

<pre><code>## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
</code></pre>

<pre><code class="r">pmlData$classe=as.factor(pmlData$classe)

inTrain = createDataPartition(pmlData$classe, p = .6)[[1]]
training = pmlData[ inTrain,]
validationset = pmlData[-inTrain,]
</code></pre>

<p>See how the dataset is boobytrapped.</p>

<pre><code class="r">qplot(seq_along(training$classe),training$classe)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-2"/> </p>

<pre><code class="r">qplot(training$X,training$classe)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-3"/> </p>

<pre><code class="r">excludes=&quot;timestamp|X|user_name|new_window&quot;

#training&lt;-training[,colSums(is.na(training)) &lt; nrow(training) ] 
#testing&lt;-testingsrc[,colSums(is.na(testingsrc)) &lt; nrow(testingsrc) ]
#training1 &lt;- subset( trainingsrc, select = -X )
NAs &lt;- apply(training,2,function(x) {sum(is.na(x))}) 
training &lt;- training[,which(NAs == 0)] 
removeIndex &lt;- grep(excludes, names(training))
training &lt;- training[,-removeIndex]


if(testmethod==&quot;rpart&quot;) {
  set.seed(975)
  modfit=train(training$classe ~ ., method=&quot;rpart&quot;, data=training )
  print(modfit$finalModel)
  plot(modfit$finalModel,uniform=TRUE,main=&quot;tree&quot;)
  text(modfit$finalModel,use.n=TRUE,all=TRUE,cex=.8)
  fancyRpartPlot(modfit$finalModel)  
  confusionMatrix(training$classe, predict(modfit, training))
}

### 
</code></pre>

<pre><code class="r">if(testmethod==&quot;rf&quot;) {  
#
  training&lt;- training[ sample(dim(training)[1], 6000), ] #!!!
  #training&lt;- training[ sample(dim(training)[1], 3000), ] #!!!
  #https://class.coursera.org/predmachlearn-002/forum/thread?thread_id=249#post-1024
  trctrl=trainControl(method = &quot;cv&quot;, number  = 5)
  modfitrf=train(training$classe ~ ., method=&quot;rf&quot;, data=training, trControl = trctrl, prox=TRUE )
  print(modfitrf$results)
  confusionMatrix(training$classe, predict(modfitrf, training))
}
</code></pre>

<pre><code> mtry  Accuracy     Kappa  AccuracySD     KappaSD
1    2 0.9813322 0.9764069 0.003761296 0.004757671
2   27 0.9879985 0.9848329 0.004553527 0.005754389
3   53 0.9823305 0.9776679 0.008141845 0.010287161
&gt; 
  Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 1686    0    0    0    0
         B    0 1156    0    0    0
         C    0    0 1021    0    0
         D    0    0    0 1027    0
         E    0    0    0    0 1110

  Overall Statistics


               Accuracy : 1          
                 95% CI : (0.9994, 1)
    No Information Rate : 0.281      
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16  

                  Kappa : 1          
 Mcnemar&#39;s Test P-Value : NA         

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity             1.000   1.0000   1.0000   1.0000    1.000
Specificity             1.000   1.0000   1.0000   1.0000    1.000
Pos Pred Value          1.000   1.0000   1.0000   1.0000    1.000
Neg Pred Value          1.000   1.0000   1.0000   1.0000    1.000
Prevalence              0.281   0.1927   0.1702   0.1712    0.185
Detection Rate          0.281   0.1927   0.1702   0.1712    0.185
Detection Prevalence    0.281   0.1927   0.1702   0.1712    0.185
Balanced Accuracy       1.000   1.0000   1.0000   1.0000    1.000
&gt; 

calculate out of sample error based on cross validation :

&gt;  1-0.9813322
[1] 0.0186678

</code></pre>

<p>predict with validation set to find the out of sample error.</p>

<pre><code class="r">&gt;   valp = predict(modfitrf, validationset, verbose = TRUE)
Number of training samples: 3000 
Number of test samples:     0 

rf : 7846 unknown predictions were added

&gt;   confusionMatrix(validationset$classe, valp)
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 2225    1    0    4    2
         B   14 1476   27    1    0
         C    0   23 1345    0    0
         D    0    0   23 1263    0
         E    1    9    4    6 1422

Overall Statistics

               Accuracy : 0.9853          
                 95% CI : (0.9824, 0.9879)
    No Information Rate : 0.2855          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       

                  Kappa : 0.9815          
 Mcnemar&#39;s Test P-Value : NA              

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.9933   0.9781   0.9614   0.9914   0.9986
Specificity            0.9988   0.9934   0.9964   0.9965   0.9969
Pos Pred Value         0.9969   0.9723   0.9832   0.9821   0.9861
Neg Pred Value         0.9973   0.9948   0.9917   0.9983   0.9997
Prevalence             0.2855   0.1923   0.1783   0.1624   0.1815
Detection Rate         0.2836   0.1881   0.1714   0.1610   0.1812
Detection Prevalence   0.2845   0.1935   0.1744   0.1639   0.1838
Balanced Accuracy      0.9960   0.9858   0.9789   0.9939   0.9977
&gt; 
</code></pre>

<p>1-accuracy == out of sample error: </p>

<p>1-0.9853=0.0147 </p>

<pre><code class="r">#####################
# TESTING
#####################
testing &lt;- read.csv(&quot;pml-testing.csv&quot;,as.is=T,stringsAsFactors=F)
ns=names(testing)
for(i in 1:length(ns)) { 
  name=ns[i] 
  if(  name!=&quot;classe&quot;) { 
    if( typeof(testing[,name])==&quot;character&quot;  ) { 
                                                  testing[, c(name)]=as.numeric( testing[, c(name)] )  ;
    }
#    print(sprintf(&quot;types tr %s    name %s &quot;,typeof(testing[, c(name)]), name ) )
  }}
</code></pre>

<pre><code>## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
## Warning: NAs introduced by coercion
</code></pre>

<pre><code class="r">#NAs2 &lt;- apply(testing,2,function(x) {sum(is.na(x))}) 
testing &lt;- testing[,which(NAs == 0)] 
#testing&lt;-testing[,colSums(is.na(testing)) &lt; nrow(testing) ] 

removeIndex &lt;- grep(excludes,names(testing))
#testing &lt;- subset( testing, select = removeIndex )
testing &lt;- testing[,-removeIndex]
if(testmethod==&quot;rpart&quot;) {
  predict(modfit, testing, verbose = TRUE)
}
</code></pre>

<pre><code class="r">if(testmethod==&quot;rf&quot;) {
  predict(modfitrf, testing, verbose = TRUE)
}
</code></pre>

<p>Number of training samples: 3000 
Number of test samples:     0 </p>

<p>rf : 20 unknown predictions were added</p>

<p>[1] B A B A A E D B A A B C B A E E A B B B
Levels: A B C D E</p>

</body>

</html>

